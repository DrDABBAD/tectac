{"componentChunkName":"component---src-templates-blog-post-js","path":"/docker/importexportmongodocker/","result":{"data":{"site":{"siteMetadata":{"title":"Tectac","author":"David Briggs"}},"markdownRemark":{"id":"fb592be0-4616-58a9-9454-01479cc0487e","excerpt":"Prequisites, docker container for mongodb. build  mongodb docker container with docker-compose.yml Note:\nVersion of docker compose WSL or commandline  or dosâ€¦","html":"<h2>Prequisites, docker container for mongodb.</h2>\n<p>build  mongodb docker container with docker-compose.yml</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.8\"</span>\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">mongodb</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">image</span> <span class=\"token punctuation\">:</span> mongo\n<span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> mongodb\n<span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> PUID=1000\n<span class=\"token punctuation\">-</span> PGID=1000\n<span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> /home/&lt;user<span class=\"token punctuation\">></span>/mongodb/database<span class=\"token punctuation\">:</span>/data/db\n<span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> 27017<span class=\"token punctuation\">:</span><span class=\"token number\">27017</span>\n<span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> unless<span class=\"token punctuation\">-</span>stopped</code></pre></div>\n<p>Note:\nVersion of docker compose</p>\n<p>WSL or commandline  or dos cml for starting docker ?</p>\n<h3>volume commands</h3>\n<p> List docker volumes\ndocker volume ls\nIbspect volume\ndocker volume inspect acc_mongodata\nDelect volume\ndocker volume rm my-vol</p>\n<h3>mapping docker volume to dos directory</h3>\n<p>You can not use native Windows path formats for your host directory. Instead, you need to convert your path into a quasi-Linux format.\ndocker run -it --volume <host directory>:<target directory>\nExample\ndocker run -it --volume //c/Users/david/my_project:/home/project ubuntu:latest</p>\n<h4>But what about docker compose</h4>\n<h2>Import and Export mongodb from docker container</h2>\n<h3>Using mongo tools</h3>\n<p>mongodump --uri 'mongodb://localhost:27017/yourdatabase' --archive=<your file> --gzip\nmongorestore --uri 'mongodb://remotehost:27017/yourdatabase' --archive=<your file> --gzip</p>\n<h3>But what if you don't have mongo on your local machine?</h3>\n<p>For the export then use:</p>\n<p>docker exec -i &#x3C;container<em>name> /usr/bin/mongodump --username <username> --password <password> --authenticationDatabase admin --db &#x3C;database</em>name> --out /dump\ndocker cp &#x3C;container_name>:/dump ~/Downloads/dump</p>\n<p>For the import its a bit more complicated.</p>\n<ol>\n<li>\n<p>You need a user and access rights for the database to import.These are held in the admin database.\nThere are other ways to do this (document latter).</p>\n<div class=\"gatsby-highlight\" data-language=\"mongocli\"><pre class=\"language-mongocli\"><code class=\"language-mongocli\">use admin</code></pre></div>\n</li>\n</ol>\n<p>db.createUser({\nuser: \"username\",\npwd: passwordPrompt(),\nroles:[{role: \"readWrite\" , db:\"&#x3C;database_name>\"}]})</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2. copy dump file to docker container  then restore the file\n\n```docker\ndocker cp ~/Downloads/dump &lt;container_name&gt;:/&lt;dumpdir&gt;\ndocker exec -i &lt;container_name&gt; /usr/bin/mongorestore --username &lt;username&gt; --password &lt;password&gt; --authenticationDatabase admin --db &lt;database_name&gt; /&lt;dumpdir&gt;/&lt;database_name&gt;</code></pre></div>\n<p><em>Does docker cp create the destination directory?</em></p>\n<p>This is not clear from the documentation, but looks as though <code class=\"language-text\">docker cp</code> does <em>not</em> create parent directories for <code class=\"language-text\">DEST_PATH</code>.</p>\n<ol start=\"3\">\n<li>Clean up</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre class=\"language-docker\"><code class=\"language-docker\"> docker exec <span class=\"token punctuation\">-</span>it &lt;container_name<span class=\"token punctuation\">></span> /bin/bash</code></pre></div>\n<p>then:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">rm</span> -rf /dump</code></pre></div>\n<h2>resources</h2>\n<p>(<a href=\"https://stackoverflow.com/questions/61400292/import-a-mongo-database-into-a-docker-container\">https://stackoverflow.com/questions/61400292/import-a-mongo-database-into-a-docker-container</a>)\n(<a href=\"https://github.com/moby/moby/issues/20920\">https://github.com/moby/moby/issues/20920</a>)\n<a href=\"https://davejansen.com/how-to-dump-restore-a-mongodb-database-from-a-docker-container/\">dump and pump data</a></p>","frontmatter":{"title":"Mongodb, docker and import export of database.","date":"2017, Sep 11","tags":["docker","mongodb"],"img":null}}},"pageContext":{"slug":"/docker/importexportmongodocker/","previous":{"fields":{"slug":"/docker/dockerresoruces/"},"frontmatter":{"title":"docker","tags":["docker","mongodb"],"img":null}},"next":{"fields":{"slug":"/aspnetcore/"},"frontmatter":{"title":"When to use a reverse proxy with the ASP.NET Core Kestrel web server","tags":["appsettings.json","ASP.NET Core Identity","cookie","Cookie","Blazor","Blazor Server","Blazor WebAssembly","Identity","Let's Encrypt","Razor","SignalR"],"img":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABZnagoCwz/8QAGRAAAwADAAAAAAAAAAAAAAAAAQIDABIx/9oACAEBAAEFAlkoyyjRIoVHO5Rzv//EABcRAQADAAAAAAAAAAAAAAAAAAACERL/2gAIAQMBAT8BpqL/xAAWEQEBAQAAAAAAAAAAAAAAAAAAEQH/2gAIAQIBAT8Bqa//xAAbEAACAQUAAAAAAAAAAAAAAAAAAREQISIycf/aAAgBAQAGPwI1nhlZ0hjg/8QAGhABAAIDAQAAAAAAAAAAAAAAAQAhETFBUf/aAAgBAQABPyHbZSPo2aKQUl6ixZhCtknEAr2f/9oADAMBAAIAAwAAABCzL//EABYRAQEBAAAAAAAAAAAAAAAAABEAIf/aAAgBAwEBPxAEOF//xAAWEQEBAQAAAAAAAAAAAAAAAAARACH/2gAIAQIBAT8QTPrf/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARMUFhIVH/2gAIAQEAAT8QRK6wtBC/UqIt73ZDn5KdTJGqeYvUSCtUF8B1n//Z"},"images":{"fallback":{"src":"/static/d0638a9c17107dbd01665305ccfe940a/1eb4c/software.jpg","srcSet":"/static/d0638a9c17107dbd01665305ccfe940a/53c59/software.jpg 750w,\n/static/d0638a9c17107dbd01665305ccfe940a/64b93/software.jpg 1080w,\n/static/d0638a9c17107dbd01665305ccfe940a/1eb4c/software.jpg 1280w","sizes":"100vw"},"sources":[{"srcSet":"/static/d0638a9c17107dbd01665305ccfe940a/3970f/software.webp 750w,\n/static/d0638a9c17107dbd01665305ccfe940a/90a5d/software.webp 1080w,\n/static/d0638a9c17107dbd01665305ccfe940a/a02e4/software.webp 1280w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.665625}}}}}}},"staticQueryHashes":["2478211480","63159454"]}